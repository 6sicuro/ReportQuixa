select t1.data, nvl(t2.numero_quotazioni_ricevute,0) as numero_quotazioni_ricevute,nvl(t3.numero_preventivi_bestPrice,0) as numero_preventivi_bestPrice,nvl(t4.numero_salvataggi_naturali,0) as numero_salvataggi_naturali,nvl(t5.numero_salvataggi_forzati,0) as numero_salvataggi_forzati,nvl(t6.numero_salvataggi_ricalcolo,0) as numero_salvataggi_ricalcolo,nvl(round(((t2.numero_quotazioni_ricevute/t7.totale_calcolati)*100),2),0) as footprint,nvl(round(((t8.totale_errori_naturali/t4.numero_salvataggi_naturali)*100),2),0) as salvataggi_naturali_falliti,nvl(round(((t9.totale_errori_forzati/t5.numero_salvataggi_forzati)*100),2),0) as salvataggi_forzati_falliti,nvl(round((((t10.totale_ricalcolo_automatici-t6.numero_salvataggi_ricalcolo)/(t10.totale_ricalcolo_automatici))*100),2),0) as salvataggi_falliti_ricalcolo,t11.prodotto
from
 (select to_char(t.data_ins,'yyyy-mm-dd') as data from sei.tab_classifica_ass_utente t where (to_char(t.data_ins,'yyyy-mm-dd')>=to_char((sysdate-7),'yyyy-mm-dd') and to_char(t.data_ins,'yyyy-mm-dd') < to_char(sysdate,'yyyy-mm-dd'))) t1,
 (select count(t.prvid) as numero_quotazioni_ricevute,to_char(t.data_ins,'yyyy-mm-dd') as data1 from sei.tab_classifica_ass_utente t where (to_char(t.data_ins,'yyyy-mm-dd')>=to_char((sysdate-7),'yyyy-mm-dd') and to_char(t.data_ins,'yyyy-mm-dd') < to_char(sysdate,'yyyy-mm-dd')) and t.tipo='A' and t.garanzia=1 and t.cid=23 group by to_char(t.data_ins,'yyyy-mm-dd')) t2,
 (select count(t.prvid) as numero_preventivi_bestPrice,to_char(t.data_ins,'yyyy-mm-dd') as data2 from sei.tab_classifica_ass_utente t where (to_char(t.data_ins,'yyyy-mm-dd')>=to_char((sysdate-7),'yyyy-mm-dd') and to_char(t.data_ins,'yyyy-mm-dd') < to_char(sysdate,'yyyy-mm-dd')) and t.tipo='A' and t.garanzia=1 and t.posizione=1 and t.cid=23 group by to_char(t.data_ins,'yyyy-mm-dd')) t3,
 (select count(distinct(g.prvid)) as numero_salvataggi_naturali,to_char(g.data,'yyyy-mm-dd') as data3 from sei.log_clickthrough g where (to_char(g.data,'yyyy-mm-dd')>=to_char((sysdate-7),'yyyy-mm-dd') and to_char(g.data,'yyyy-mm-dd') < to_char(sysdate,'yyyy-mm-dd')) and g.cid=23 and g.prodotto='A' and g.flag_tipo_pass=0 group by to_char(g.data,'yyyy-mm-dd')) t4,
 (select count(g.prvid) as numero_salvataggi_forzati,to_char(g.data,'yyyy-mm-dd') as data4 from sei.log_clickthrough g where (to_char(g.data,'yyyy-mm-dd')>=to_char((sysdate-7),'yyyy-mm-dd') and to_char(g.data,'yyyy-mm-dd') < to_char(sysdate,'yyyy-mm-dd')) and g.cid=23 and g.prodotto='A' and g.flag_tipo_pass=2 group by to_char(g.data,'yyyy-mm-dd')) t5,
 (select nvl(count(distinct(r.prvid)),0) as numero_salvataggi_ricalcolo,to_char(r.data_ricalcolo,'yyyy-mm-dd') as data8 from ricalcoli r where (to_char(r.data_ricalcolo,'yyyy-mm-dd')>=to_char((sysdate-7),'yyyy-mm-dd') and to_char(r.data_ricalcolo,'yyyy-mm-dd') < to_char(sysdate,'yyyy-mm-dd') and r.prodotto='A' and r.comp_salvataggio=23) group by to_char(r.data_ricalcolo,'yyyy-mm-dd')) t6,
 (select count(t.posizione) as totale_calcolati,to_char(t.data_ins,'yyyy-mm-dd') as data5 from sei.tab_classifica_ass_utente t where (to_char(t.data_ins,'yyyy-mm-dd')>=to_char((sysdate-7),'yyyy-mm-dd') and to_char(t.data_ins,'yyyy-mm-dd') < to_char(sysdate,'yyyy-mm-dd')) and t.posizione=1 and t.tipo='A' and t.garanzia=1 group by to_char(t.data_ins,'yyyy-mm-dd')) t7,
 (select count(distinct(g.prvid)) as totale_errori_naturali,to_char(g.data,'yyyy-mm-dd') as data6 from sei.log_clickthrough g where (to_char(g.data,'yyyy-mm-dd')>=to_char((sysdate-7),'yyyy-mm-dd') and to_char(g.data,'yyyy-mm-dd') < to_char(sysdate,'yyyy-mm-dd')) and g.cid=23 and g.prodotto='A' and length(g.numeropreventivo)<=3 and g.flag_tipo_pass=0 group by to_char(g.data,'yyyy-mm-dd')) t8, 
 (select count(g.prvid) as totale_errori_forzati,to_char(g.data,'yyyy-mm-dd') as data7 from sei.log_clickthrough g where (to_char(g.data,'yyyy-mm-dd')>=to_char((sysdate-7),'yyyy-mm-dd') and to_char(g.data,'yyyy-mm-dd') < to_char(sysdate,'yyyy-mm-dd')) and g.cid=23 and g.prodotto='A' and length(g.numeropreventivo)<=3 and g.flag_tipo_pass=2 group by to_char(g.data,'yyyy-mm-dd')) t9,
 (select nvl(count(distinct(r.prvid)),0) as totale_ricalcolo_automatici,to_char(r.data_ricalcolo,'yyyy-mm-dd') as data9 from  sei.ricalcoli r,classifica_ricalcoli c where (c.prvid=r.prvid and c.cid=23 and c.posizione=1 and c.tipo=1) and (to_char(r.data_ricalcolo,'yyyy-mm-dd')>=to_char((sysdate-7),'yyyy-mm-dd') and to_char(r.data_ricalcolo,'yyyy-mm-dd') < to_char(sysdate,'yyyy-mm-dd') and salvataggio='N' and r.prodotto='A')  group by to_char(r.data_ricalcolo,'yyyy-mm-dd')) t10,
 (select 'A' as prodotto  from dual) t11
  where t1.data=t2.data1(+) and t1.data=t3.data2(+) and t1.data=t4.data3(+) and t1.data=t5.data4(+) and t1.data=t7.data5(+) and t1.data=t8.data6(+) and t1.data=t9.data7(+) and t1.data=t6.data8(+) and t1.data=t10.data9(+)
   group by t1.data,t2.numero_quotazioni_ricevute,t3.numero_preventivi_bestPrice,t4.numero_salvataggi_naturali,t5.numero_salvataggi_forzati,t6.numero_salvataggi_ricalcolo,t7.totale_calcolati,t8.totale_errori_naturali,t9.totale_errori_forzati,t10.totale_ricalcolo_automatici,t11.prodotto
union 
select t1.data, nvl(t2.numero_quotazioni_ricevute,0) as numero_quotazioni_ricevute,nvl(t3.numero_preventivi_bestPrice,0) as numero_preventivi_bestPrice,nvl(t4.numero_salvataggi_naturali,0) as numero_salvataggi_naturali,nvl(t5.numero_salvataggi_forzati,0) as numero_salvataggi_forzati,nvl(t6.numero_salvataggi_ricalcolo,0) as numero_salvataggi_ricalcolo,nvl(round(((t2.numero_quotazioni_ricevute/t7.totale_calcolati)*100),2),0) as footprint,nvl(round(((t8.totale_errori_naturali/t4.numero_salvataggi_naturali)*100),2),0) as salvataggi_naturali_falliti,nvl(round(((t9.totale_errori_forzati/t5.numero_salvataggi_forzati)*100),2),0) as salvataggi_forzati_falliti,nvl(round((((t10.totale_ricalcolo_automatici-t6.numero_salvataggi_ricalcolo)/(t10.totale_ricalcolo_automatici))*100),2),0) as salvataggi_falliti_ricalcolo,t11.prodotto
from
 (select to_char(t.data_ins,'yyyy-mm-dd') as data from sei.tab_classifica_ass_utente t where (to_char(t.data_ins,'yyyy-mm-dd')>=to_char((sysdate-7),'yyyy-mm-dd') and to_char(t.data_ins,'yyyy-mm-dd') < to_char(sysdate,'yyyy-mm-dd'))) t1,
 (select count(t.prvid) as numero_quotazioni_ricevute,to_char(t.data_ins,'yyyy-mm-dd') as data1 from sei.tab_classifica_ass_utente t where (to_char(t.data_ins,'yyyy-mm-dd')>=to_char((sysdate-7),'yyyy-mm-dd') and to_char(t.data_ins,'yyyy-mm-dd') < to_char(sysdate,'yyyy-mm-dd')) and t.tipo='A' and t.garanzia=1 and t.cid=30 group by to_char(t.data_ins,'yyyy-mm-dd')) t2,
 (select count(t.prvid) as numero_preventivi_bestPrice,to_char(t.data_ins,'yyyy-mm-dd') as data2 from sei.tab_classifica_ass_utente t where (to_char(t.data_ins,'yyyy-mm-dd')>=to_char((sysdate-7),'yyyy-mm-dd') and to_char(t.data_ins,'yyyy-mm-dd') < to_char(sysdate,'yyyy-mm-dd')) and t.tipo='A' and t.garanzia=1 and t.posizione=1 and t.cid=30 group by to_char(t.data_ins,'yyyy-mm-dd')) t3,
 (select count(distinct(g.prvid)) as numero_salvataggi_naturali,to_char(g.data,'yyyy-mm-dd') as data3 from sei.log_clickthrough g where (to_char(g.data,'yyyy-mm-dd')>=to_char((sysdate-7),'yyyy-mm-dd') and to_char(g.data,'yyyy-mm-dd') < to_char(sysdate,'yyyy-mm-dd')) and g.cid=30 and g.prodotto='A' and g.flag_tipo_pass=0 group by to_char(g.data,'yyyy-mm-dd')) t4,
 (select count(g.prvid) as numero_salvataggi_forzati,to_char(g.data,'yyyy-mm-dd') as data4 from sei.log_clickthrough g where (to_char(g.data,'yyyy-mm-dd')>=to_char((sysdate-7),'yyyy-mm-dd') and to_char(g.data,'yyyy-mm-dd') < to_char(sysdate,'yyyy-mm-dd')) and g.cid=30 and g.prodotto='A' and g.flag_tipo_pass=2 group by to_char(g.data,'yyyy-mm-dd')) t5,
 (select nvl(count(distinct(r.prvid)),0) as numero_salvataggi_ricalcolo,to_char(r.data_ricalcolo,'yyyy-mm-dd') as data8 from ricalcoli r where (to_char(r.data_ricalcolo,'yyyy-mm-dd')>=to_char((sysdate-7),'yyyy-mm-dd') and to_char(r.data_ricalcolo,'yyyy-mm-dd') < to_char(sysdate,'yyyy-mm-dd') and r.prodotto='A' and r.comp_salvataggio=30) group by to_char(r.data_ricalcolo,'yyyy-mm-dd')) t6,
 (select count(t.posizione) as totale_calcolati,to_char(t.data_ins,'yyyy-mm-dd') as data5 from sei.tab_classifica_ass_utente t where (to_char(t.data_ins,'yyyy-mm-dd')>=to_char((sysdate-7),'yyyy-mm-dd') and to_char(t.data_ins,'yyyy-mm-dd') < to_char(sysdate,'yyyy-mm-dd')) and t.posizione=1 and t.tipo='A' and t.garanzia=1 group by to_char(t.data_ins,'yyyy-mm-dd')) t7,
 (select count(distinct(g.prvid)) as totale_errori_naturali,to_char(g.data,'yyyy-mm-dd') as data6 from sei.log_clickthrough g where (to_char(g.data,'yyyy-mm-dd')>=to_char((sysdate-7),'yyyy-mm-dd') and to_char(g.data,'yyyy-mm-dd') < to_char(sysdate,'yyyy-mm-dd')) and g.cid=30 and g.prodotto='A' and length(g.numeropreventivo)<=3 and g.flag_tipo_pass=0 group by to_char(g.data,'yyyy-mm-dd')) t8, 
 (select count(g.prvid) as totale_errori_forzati,to_char(g.data,'yyyy-mm-dd') as data7 from sei.log_clickthrough g where (to_char(g.data,'yyyy-mm-dd')>=to_char((sysdate-7),'yyyy-mm-dd') and to_char(g.data,'yyyy-mm-dd') < to_char(sysdate,'yyyy-mm-dd')) and g.cid=30 and g.prodotto='A' and length(g.numeropreventivo)<=3 and g.flag_tipo_pass=2 group by to_char(g.data,'yyyy-mm-dd')) t9,
 (select nvl(count(distinct(r.prvid)),0) as totale_ricalcolo_automatici,to_char(r.data_ricalcolo,'yyyy-mm-dd') as data9 from  sei.ricalcoli r,classifica_ricalcoli c where (c.prvid=r.prvid and c.cid=30 and c.posizione=1 and c.tipo=1) and (to_char(r.data_ricalcolo,'yyyy-mm-dd')>=to_char((sysdate-7),'yyyy-mm-dd') and to_char(r.data_ricalcolo,'yyyy-mm-dd') < to_char(sysdate,'yyyy-mm-dd') and salvataggio='N' and r.prodotto='A')  group by to_char(r.data_ricalcolo,'yyyy-mm-dd')) t10,
 (select 'BLACK BOX' as prodotto  from dual) t11
  where t1.data=t2.data1(+) and t1.data=t3.data2(+) and t1.data=t4.data3(+) and t1.data=t5.data4(+) and t1.data=t7.data5(+) and t1.data=t8.data6(+) and t1.data=t9.data7(+) and t1.data=t6.data8(+) and t1.data=t10.data9(+)
   group by t1.data,t2.numero_quotazioni_ricevute,t3.numero_preventivi_bestPrice,t4.numero_salvataggi_naturali,t5.numero_salvataggi_forzati,t6.numero_salvataggi_ricalcolo,t7.totale_calcolati,t8.totale_errori_naturali,t9.totale_errori_forzati,t10.totale_ricalcolo_automatici,t11.prodotto
union 
select t1.data, nvl(t2.numero_quotazioni_ricevute,0) as numero_quotazioni_ricevute,nvl(t3.numero_preventivi_bestPrice,0) as numero_preventivi_bestPrice,nvl(t4.numero_salvataggi_naturali,0) as numero_salvataggi_naturali,nvl(t5.numero_salvataggi_forzati,0) as numero_salvataggi_forzati,nvl(t6.numero_salvataggi_ricalcolo,0) as numero_salvataggi_ricalcolo,round(((t2.numero_quotazioni_ricevute/t7.totale_calcolati)*100),2) as footprint,nvl(round(((t8.totale_errori_naturali/t4.numero_salvataggi_naturali)*100),2),0) as salvataggi_naturali_falliti,nvl(round(((t9.totale_errori_forzati/t5.numero_salvataggi_forzati)*100),2),0) as salvataggi_forzati_falliti,nvl(round((((t10.totale_ricalcolo_automatici-t6.numero_salvataggi_ricalcolo)/(t10.totale_ricalcolo_automatici))*100),2),0) as salvataggi_falliti_ricalcolo,t11.prodotto
from
 (select to_char(t.data_ins,'yyyy-mm-dd') as data from sei.tab_classifica_ass_utente t where (to_char(t.data_ins,'yyyy-mm-dd')>=to_char((sysdate-7),'yyyy-mm-dd') and to_char(t.data_ins,'yyyy-mm-dd') < to_char(sysdate,'yyyy-mm-dd'))) t1,
 (select count(t.prvid) as numero_quotazioni_ricevute,to_char(t.data_ins,'yyyy-mm-dd') as data1 from sei.tab_classifica_ass_utente t where (to_char(t.data_ins,'yyyy-mm-dd')>=to_char((sysdate-7),'yyyy-mm-dd') and to_char(t.data_ins,'yyyy-mm-dd') < to_char(sysdate,'yyyy-mm-dd')) and t.tipo='M' and t.garanzia=1 and t.cid=23 group by to_char(t.data_ins,'yyyy-mm-dd')) t2,
 (select count(t.prvid) as numero_preventivi_bestPrice,to_char(t.data_ins,'yyyy-mm-dd') as data2 from sei.tab_classifica_ass_utente t where (to_char(t.data_ins,'yyyy-mm-dd')>=to_char((sysdate-7),'yyyy-mm-dd') and to_char(t.data_ins,'yyyy-mm-dd') < to_char(sysdate,'yyyy-mm-dd')) and t.tipo='M' and t.garanzia=1 and t.posizione=1 and t.cid=23 group by to_char(t.data_ins,'yyyy-mm-dd')) t3,
 (select count(g.prvid) as numero_salvataggi_naturali,to_char(g.data,'yyyy-mm-dd') as data3 from sei.log_clickthrough g where (to_char(g.data,'yyyy-mm-dd')>=to_char((sysdate-7),'yyyy-mm-dd') and to_char(g.data,'yyyy-mm-dd') < to_char(sysdate,'yyyy-mm-dd')) and g.cid=23 and g.prodotto='M' and g.flag_tipo_pass=0 group by to_char(g.data,'yyyy-mm-dd')) t4,
 (select count(g.prvid) as numero_salvataggi_forzati,to_char(g.data,'yyyy-mm-dd') as data4 from sei.log_clickthrough g where (to_char(g.data,'yyyy-mm-dd')>=to_char((sysdate-7),'yyyy-mm-dd') and to_char(g.data,'yyyy-mm-dd') < to_char(sysdate,'yyyy-mm-dd')) and g.cid=23 and g.prodotto='M' and g.flag_tipo_pass=2 group by to_char(g.data,'yyyy-mm-dd')) t5,
 (select nvl(count(distinct(r.prvid)),0) as numero_salvataggi_ricalcolo,to_char(r.data_ricalcolo,'yyyy-mm-dd') as data8 from ricalcoli r where (to_char(r.data_ricalcolo,'yyyy-mm-dd')>=to_char((sysdate-7),'yyyy-mm-dd') and to_char(r.data_ricalcolo,'yyyy-mm-dd') < to_char(sysdate,'yyyy-mm-dd') and r.prodotto='M' and r.comp_salvataggio=23) group by to_char(r.data_ricalcolo,'yyyy-mm-dd')) t6,
 (select count(t.posizione) as totale_calcolati,to_char(t.data_ins,'yyyy-mm-dd') as data5 from sei.tab_classifica_ass_utente t where (to_char(t.data_ins,'yyyy-mm-dd')>=to_char((sysdate-7),'yyyy-mm-dd') and to_char(t.data_ins,'yyyy-mm-dd') < to_char(sysdate,'yyyy-mm-dd')) and t.posizione=1 and t.tipo='M' and t.garanzia=1 group by to_char(t.data_ins,'yyyy-mm-dd')) t7,
 (select count(distinct(g.prvid)) as totale_errori_naturali,to_char(g.data,'yyyy-mm-dd') as data6 from sei.log_clickthrough g where (to_char(g.data,'yyyy-mm-dd')>=to_char((sysdate-7),'yyyy-mm-dd') and to_char(g.data,'yyyy-mm-dd') < to_char(sysdate,'yyyy-mm-dd')) and g.cid=23 and g.prodotto='M' and length(g.numeropreventivo)<=3 and g.flag_tipo_pass=0 group by to_char(g.data,'yyyy-mm-dd')) t8, 
 (select count(g.prvid) as totale_errori_forzati,to_char(g.data,'yyyy-mm-dd') as data7 from sei.log_clickthrough g where (to_char(g.data,'yyyy-mm-dd')>=to_char((sysdate-7),'yyyy-mm-dd') and to_char(g.data,'yyyy-mm-dd') < to_char(sysdate,'yyyy-mm-dd')) and g.cid=23 and g.prodotto='M' and length(g.numeropreventivo)<=3 and g.flag_tipo_pass=2 group by to_char(g.data,'yyyy-mm-dd')) t9,
 (select nvl(count(distinct(r.prvid)),0) as totale_ricalcolo_automatici,to_char(r.data_ricalcolo,'yyyy-mm-dd') as data9 from  sei.ricalcoli r,classifica_ricalcoli c where (c.prvid=r.prvid and c.cid=23 and c.posizione=1 and c.tipo=1) and (to_char(r.data_ricalcolo,'yyyy-mm-dd')>=to_char((sysdate-7),'yyyy-mm-dd') and to_char(r.data_ricalcolo,'yyyy-mm-dd') < to_char(sysdate,'yyyy-mm-dd') and salvataggio='N' and r.prodotto='M')  group by to_char(r.data_ricalcolo,'yyyy-mm-dd')) t10,
 (select 'M' as prodotto  from dual) t11
 where t1.data=t2.data1(+) and t1.data=t3.data2(+) and t1.data=t4.data3(+) and t1.data=t5.data4(+) and t1.data=t7.data5(+) and t1.data=t8.data6(+) and t1.data=t9.data7(+) and t1.data=t6.data8(+) and t1.data=t10.data9(+)
   group by t1.data,t2.numero_quotazioni_ricevute,t3.numero_preventivi_bestPrice,t4.numero_salvataggi_naturali,t5.numero_salvataggi_forzati,t6.numero_salvataggi_ricalcolo,t7.totale_calcolati,t8.totale_errori_naturali,t9.totale_errori_forzati,t10.totale_ricalcolo_automatici,t11.prodotto
    order by prodotto,data